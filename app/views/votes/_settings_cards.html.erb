<% 
  # Wheel variables
  wheel_mode = Current.game_session.wheel_filter_mode
  wheel_mode_label = case wheel_mode
    when "top_x" then "Top #{Current.game_session.wheel_filter_top_count}"
    when "all" then "All Games"
    when "winners" then "Winners"
    else "Configured"
  end
  wheel_description = case wheel_mode
    when "top_x"
      "Wheel spins among the top #{Current.game_session.wheel_filter_top_count} voted games#{Current.game_session.wheel_proportional? ? ' with weighted slices' : ' with equal chances'}."
    when "all"
      "Every game gets a spot on the wheel#{Current.game_session.wheel_proportional? ? ', sized by vote count' : ' with equal odds'}."
    when "winners"
      "Only tied top-voted games compete on the wheel for the final pick."
    else
      "Wheel is configured and ready to spin."
  end

  settings = [
    {
      title: "Bonus Votes Pool",
      value: "+#{Current.game_session.bonus_votes} pts",
      description: "A global pool of #{Current.game_session.bonus_votes} bonus votes is available for all users to distribute.",
      icon: "gift",
      enabled: Current.game_session.enable_bonus_votes
    },
    {
      title: "Punish Previous Game Tags",
      value: "-#{Current.game_session.previous_game_penalty} pts",
      description: "Votes for games with tags matching the previous game are penalized by #{Current.game_session.previous_game_penalty} points.",
      icon: "shield-exclamation",
      enabled: Current.game_session.punish_previous_game_tags
    },
    {
      title: "Countdown",
      value: "#{Current.game_session.voting_countdown_duration_minutes} min",
      description: "Voting session has a timer and will end automatically after the time expires.",
      icon: "clock",
      enabled: Current.game_session.voting_countdown_enabled
    },
    {
      title: "Wheel",
      value: wheel_mode_label,
      description: wheel_description,
      icon: "arrow-path",
      enabled: Current.game_session.wheel_enabled,
      is_wheel: true
    }
  ].select { |s| s[:enabled] }
  
  is_vertical = local_assigns[:vertical]
%>

<div id="settings_cards_<%= is_vertical ? 'vertical' : 'grid' %>">
<% if settings.any? || Current.game_session.wheel_enabled %>
  <%# Mobile Concise View %>
  <div class="lg:hidden mb-2 space-y-1">
    <div class="flex flex-wrap items-center gap-x-3 gap-y-1 text-[11px] font-medium text-slate-400 bg-slate-900/50 border border-slate-800/50 rounded-xl p-3">
      <div class="flex items-center gap-1.5 text-purple-400">
        <%= heroicon "adjustments-horizontal", variant: :solid, options: { class: "w-3.5 h-3.5" } %>
        <span class="font-bold uppercase tracking-wider text-[10px]">Active Settings:</span>
      </div>
      
      <% settings.each do |setting| %>
        <div class="flex items-center gap-1">
          <div class="w-1 h-1 rounded-full bg-slate-700"></div>
          <span><%= setting[:title] %>: <span class="text-slate-200"><%= setting[:value] %></span></span>
        </div>
      <% end %>
    </div>
  </div>

  <%# Desktop/Tablet Grid View %>
  <div class="hidden lg:flex <%= is_vertical ? 'flex-col gap-4' : 'flex-wrap items-center justify-center gap-6 mb-10 mt-2' %>">
    <% settings.each do |setting| %>
      <% if setting[:is_wheel] %>
        <%# Wheel of Fortune Card - Rainbow Theme %>
        <div class="relative group aspect-[3/4] max-w-[200px] w-full">
          <!-- Rainbow Glow effect - Animated -->
          <div class="absolute -inset-0.5 bg-gradient-to-br from-rose-500 via-amber-400 via-30% via-emerald-400 via-50% via-cyan-400 via-70% to-violet-500 rounded-[1.8rem] blur-lg opacity-40 group-hover:opacity-70 transition duration-500"></div>
          
          <div class="relative h-full flex flex-col items-center justify-center p-5 bg-[#0f111a] border border-white/10 rounded-[1.8rem] text-center overflow-hidden shadow-2xl">
            
            <!-- Floating Icon with Rainbow Glow -->
            <div class="mb-4 relative">
                <div class="absolute inset-0 bg-gradient-to-r from-amber-400 via-emerald-400 to-cyan-400 blur-xl opacity-40"></div>
                <div class="relative">
                    <%= heroicon "arrow-path", variant: :solid, options: { class: "w-10 h-10 text-transparent bg-gradient-to-br from-rose-400 via-amber-300 via-emerald-300 to-cyan-400 bg-clip-text drop-shadow-[0_0_15px_rgba(251,191,36,0.6)]" } %>
                    <svg class="w-10 h-10 absolute inset-0" fill="url(#rainbow-gradient)" viewBox="0 0 24 24">
                      <defs>
                        <linearGradient id="rainbow-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                          <stop offset="0%" style="stop-color:#f43f5e"/>
                          <stop offset="25%" style="stop-color:#fbbf24"/>
                          <stop offset="50%" style="stop-color:#34d399"/>
                          <stop offset="75%" style="stop-color:#22d3ee"/>
                          <stop offset="100%" style="stop-color:#a78bfa"/>
                        </linearGradient>
                      </defs>
                      <path d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"/>
                    </svg>
                </div>
            </div>
            
            <h3 class="text-base font-bold bg-gradient-to-r from-rose-300 via-amber-200 to-emerald-300 bg-clip-text text-transparent mb-1 tracking-tight">Wheel of Fortune</h3>
            <p class="text-lg font-black bg-gradient-to-r from-amber-400 via-emerald-400 to-cyan-400 bg-clip-text text-transparent mb-3 uppercase tracking-widest">
              <%= setting[:value] %>
            </p>
            <p class="text-[10px] text-slate-400 leading-tight font-medium px-1">
              <%= setting[:description] %>
            </p>

            <!-- Rainbow Bottom Accent Glow -->
            <div class="absolute bottom-0 left-0 right-0 h-16 bg-gradient-to-t from-amber-500/10 via-emerald-500/5 to-transparent pointer-events-none"></div>
          </div>
        </div>
      <% else %>
        <div class="relative group aspect-[3/4] max-w-[200px] w-full">
          <!-- Glow effect (Side-glow style from image) -->
          <div class="absolute -inset-0.5 bg-gradient-to-b from-purple-600 via-pink-600 to-purple-600 rounded-[1.8rem] blur-lg opacity-30 group-hover:opacity-60 transition duration-500"></div>
          
          <div class="relative h-full flex flex-col items-center justify-center p-5 bg-[#0f111a] border border-white/10 rounded-[1.8rem] text-center overflow-hidden shadow-2xl">
            <!-- Floating Icon with Glow -->
            <div class="mb-4 relative">
                <div class="absolute inset-0 bg-purple-500 blur-xl opacity-30"></div>
                <div class="relative text-white">
                    <%= heroicon setting[:icon], variant: :solid, options: { class: "w-10 h-10 drop-shadow-[0_0_10px_rgba(168,85,247,0.7)]" } %>
                </div>
            </div>
            
            <h3 class="text-base font-bold text-white mb-1 tracking-tight"><%= setting[:title] %></h3>
            <p class="text-lg font-black text-purple-400 mb-3 uppercase tracking-widest">
              <%= setting[:value] %>
            </p>
            <p class="text-[10px] text-slate-400 leading-tight font-medium px-1">
              <%= setting[:description] %>
            </p>

            <!-- Bottom Accent Glow -->
            <div class="absolute bottom-0 left-0 right-0 h-16 bg-gradient-to-t from-purple-600/10 to-transparent pointer-events-none"></div>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>
<% end %>
</div>
