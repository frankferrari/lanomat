<% is_leader = game_iteration.index == 0 && game.votes > 0 %>

<div id="<%= dom_id game %>" class="relative group/card bg-slate-900 rounded-2xl border transition-all duration-300 p-5 flex flex-col justify-between <%= is_leader ? 'border-yellow-500/50 ring-1 ring-yellow-500/20 shadow-xl' : 'border-slate-800 hover:border-slate-700' %> 
    group-data-[view=list]/view:grid group-data-[view=list]/view:grid-cols-12 group-data-[view=list]/view:items-center group-data-[view=list]/view:gap-4 group-data-[view=list]/view:p-3">
  
  <% if is_leader %>
    <div class="absolute -top-3 left-1/2 -translate-x-1/2 bg-yellow-500 text-slate-950 text-xs font-black uppercase px-3 py-0.5 rounded-full flex items-center gap-1 shadow-lg z-10 
        group-data-[view=list]/view:hidden">
      <%= heroicon "trophy", variant: :outline, options: { class: "w-3 h-3" } %>
      <span>Leading</span>
    </div>
  <% end %>

  <div class="flex justify-between items-start mb-0 group-data-[view=list]/view:contents group-data-[view=list]/view:mb-0">
    <div class="group-data-[view=list]/view:col-span-10 group-data-[view=list]/view:order-1 flex flex-col justify-center gap-2">
      <h3 class="font-bold text-md leading-tight group-hover/card:text-purple-400 transition-colors truncate flex items-center gap-2">
        <%= game.name %>
        <% if is_leader %>
            <span class="hidden group-data-[view=list]/view:inline-flex bg-yellow-500 text-slate-950 p-0.5 rounded-full" title="Leading">
                <%= heroicon "trophy", variant: :outline, options: { class: "w-3 h-3" } %>
            </span>
        <% end %>
      </h3>
      
      <% if game.tags.any? %>
        <div class="flex flex-wrap gap-1 group-data-[view=list]/view:mt-0.5">
            <% game.tags.each do |tag| %>
              <span class="text-xs text-purple-300 font-bold bg-purple-600/20 border border-purple-500/30 px-2 py-0.5 rounded-md uppercase tracking-wider"><%= tag.name %></span>
            <% end %>
        </div>
      <% end %>

      <% if game.price.present? || game.max_players.present? %>
        <div class="flex flex-wrap gap-4 items-center mt-1 group-data-[view=list]/view:mt-0">
            <% if game.price.present? %>
                <div class="flex items-center gap-1.5 text-slate-400">
                    <%= heroicon "tag", variant: :outline, options: { class: "w-3.5 h-3.5 text-purple-500" } %>
                    <span class="text-xs font-medium"><%= game.price %></span>
                </div>
            <% end %>
            <% if game.max_players.present? %>
                <div class="flex items-center gap-1.5 text-slate-400">
                    <%= heroicon "user-group", variant: :outline, options: { class: "w-3.5 h-3.5 text-blue-500" } %>
                    <span class="text-xs font-medium"><%= game.max_players %> Max</span>
                </div>
            <% end %>
        </div>
      <% end %>
    </div>

    <div class="flex flex-col items-center bg-slate-950 border border-slate-800 p-2 rounded-xl min-w-14 
        group-data-[view=list]/view:flex-row group-data-[view=list]/view:py-1 group-data-[view=list]/view:px-3 group-data-[view=list]/view:gap-3 group-data-[view=list]/view:min-w-0
        group-data-[view=list]/view:col-span-2 group-data-[view=list]/view:order-2 group-data-[view=list]/view:justify-self-end">
      
      <%= button_to vote_game_path(game, direction: 'up'), method: :post, class: "p-1 hover:text-green-400 transition-colors group/up" do %>
        <%= heroicon "chevron-up", variant: :outline, options: { class: "w-5 h-5 group-active/up:scale-90 transition-transform" } %>
      <% end %>
      
      <span class="text-xl font-black text-white group-data-[view=list]/view:text-base min-w-6 text-center"><%= game.votes %></span>
      
      <%= button_to vote_game_path(game, direction: 'down'), method: :post, class: "p-1 hover:text-red-400 transition-colors group/down" do %>
        <%= heroicon "chevron-down", variant: :outline, options: { class: "w-5 h-5 group-active/down:scale-90 transition-transform" } %>
      <% end %>
    </div>
  </div>
</div>
