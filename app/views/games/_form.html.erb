<%= form_with(model: game, class: "bg-slate-900 p-6 rounded-2xl border border-slate-800 shadow-xl grid grid-cols-1 sm:grid-cols-4 gap-4") do |form| %>
  <!-- Form Validation Messages -->
  <% if game.errors.any? %>
    <div style="color: red" class="col-span-full mb-4">
      <h2><%= pluralize(game.errors.count, "error") %> prohibited this game from being saved:</h2>
      <ul>
        <% game.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <!-- Row 1: Title (Left) -->
  <div class="sm:col-span-2 space-y-1">
    <%= form.label :name, "TITLE", class: "text-xs font-bold text-slate-500 uppercase tracking-widest ml-1" %>
    <%= form.text_field :name, required: true, placeholder: "Quake III Arena", class: "w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-purple-500 outline-none transition-all text-white placeholder-slate-700" %>
  </div>

  <!-- Row 1: Price (Center) -->
  <div class="sm:col-span-1 space-y-1">
    <%= form.label :price, "PRICE", class: "text-xs font-bold text-slate-500 uppercase tracking-widest ml-1" %>
    <%= form.text_field :price, placeholder: "Free", class: "w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-purple-500 outline-none transition-all text-white placeholder-slate-700" %>
  </div>

  <!-- Row 1: Max Players (Right) -->
  <div class="sm:col-span-1 flex items-end gap-2">
    <div class="space-y-1 flex-1">
      <%= form.label :max_players, "PLAYERS", class: "text-xs font-bold text-slate-500 uppercase tracking-widest ml-1" %>
      <%= form.number_field :max_players, placeholder: "16", class: "w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-purple-500 outline-all text-white placeholder-slate-700" %>
    </div>
    
    <button type="submit" class="bg-purple-600 hover:bg-purple-500 p-3 rounded-xl shadow-lg transition-colors">
      <%= heroicon "plus", variant: :outline, options: { class: "w-5 h-5 text-white" } %>
    </button>
  </div>

  <!-- Row 2: Tags (Full Width) -->
  <div class="sm:col-span-4 space-y-1 relative" 
       data-controller="combobox"
       data-combobox-available-value="<%= Tag.pluck(:name).to_json %>"
       data-combobox-existing-value="<%= game.tags.pluck(:name).to_json %>">
       
    <label class="text-xs font-bold text-slate-500 uppercase tracking-widest ml-1">TAGS</label>
    
    <!-- Input Area -->
    <div class="w-full bg-slate-950 border border-slate-800 rounded-xl px-2 py-2 focus-within:ring-2 focus-within:ring-purple-500 transition-all flex flex-wrap gap-2 items-center min-h-[46px]">
      <div data-combobox-target="selectedContainer" class="flex flex-wrap gap-2"></div>
      
      <input type="text" 
             data-combobox-target="input"
             data-action="input->combobox#input keydown->combobox#keydown focus->combobox#open click->combobox#open"
             placeholder="Add tags..." 
             class="bg-transparent border-none outline-none text-white placeholder-slate-700 flex-1 min-w-[100px] text-sm h-7 focus:ring-0 p-0"
             autocomplete="off">
    </div>

    <div data-combobox-target="hiddenInputContainer" class="hidden"></div>
    
    <div data-combobox-target="suggestions" 
         class="absolute top-full left-0 right-0 mt-1 bg-slate-900 border border-slate-800 rounded-xl shadow-2xl z-50 max-h-48 overflow-y-auto hidden">
    </div>
  </div>


<% end %>
