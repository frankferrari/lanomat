<% is_leader = game_iteration.index == 0 && game.votes > 0 %>

<div id="<%= dom_id game %>" class="relative group bg-slate-900 rounded-2xl border transition-all duration-300 p-5 flex flex-col justify-between <%= is_leader ? 'border-yellow-500/50 ring-1 ring-yellow-500/20 shadow-xl' : 'border-slate-800 hover:border-slate-700' %>">
  <% if is_leader %>
    <div class="absolute -top-3 left-1/2 -translate-x-1/2 bg-yellow-500 text-slate-950 text-[10px] font-black uppercase px-3 py-0.5 rounded-full flex items-center gap-1 shadow-lg z-10">
      <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trophy w-3 h-3"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>
      Leading
    </div>
  <% end %>

  <div class="flex justify-between items-start mb-4">
    <div class="pr-12">
      <h3 class="font-bold text-lg leading-tight group-hover:text-purple-400 transition-colors truncate"><%= game.name %></h3>
      <span class="text-[10px] text-slate-400 font-bold bg-slate-800 px-2 py-0.5 rounded-md uppercase tracking-wider"><%= game.genre %></span>
    </div>
    <div class="flex flex-col items-center bg-slate-950 border border-slate-800 p-2 rounded-xl min-w-[54px]">
      <%= button_to vote_game_path(game, direction: 'up'), method: :post, class: "p-1 hover:text-green-400 transition-colors" do %>
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-up w-5 h-5"><path d="m18 15-6-6-6 6"/></svg>
      <% end %>
      
      <span class="text-xl font-black text-white"><%= game.votes %></span>
      
      <%= button_to vote_game_path(game, direction: 'down'), method: :post, class: "p-1 hover:text-red-400 transition-colors" do %>
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down w-5 h-5"><path d="m6 9 6 6 6-6"/></svg>
      <% end %>
    </div>
  </div>

  <div class="grid grid-cols-2 gap-2">
    <div class="bg-slate-950/50 p-2 rounded-lg border border-slate-800/50 flex items-center gap-2">
      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-tag w-3.5 h-3.5 text-purple-500"><path d="M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l5 5a2 2 0 0 0 1.414 0l7-7a2 2 0 0 0 0-1.414l-5-5a2 2 0 0 0-1.414-1.414z"/><path d="M7 7h.01"/></svg>
      <span class="text-xs text-slate-300 truncate"><%= game.price.presence || 'Free' %></span>
    </div>
    <div class="bg-slate-950/50 p-2 rounded-lg border border-slate-800/50 flex items-center gap-2">
      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-users w-3.5 h-3.5 text-blue-500"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
      <span class="text-xs text-slate-300"><%= game.max_players ? "#{game.max_players} Max" : 'âˆž Max' %></span>
    </div>
  </div>
  
  <div class="mt-4 flex justify-end">
    <%= button_to game_path(game), method: :delete, class: "p-2 text-slate-600 hover:text-red-500 transition-colors", form: { data: { turbo_confirm: "Are you sure?" } } do %>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash-2 w-4 h-4"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>
    <% end %>
  </div>
</div>
